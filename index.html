
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>꿈빛파티시엘노트</title>
  <meta name="theme-color" content="#ff6fa5">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <h1>꿈빛파티시엘노트</h1>
  <div class="actions">
    <button id="newRecipeBtn">+ 새 레시피</button>
    <button id="exportBtn">내보내기</button>
    <label class="importLabel">불러오기<input type="file" id="importInput" accept="application/json"></label>
  </div>
</header>

<section id="filters">
  <input type="search" id="searchInput" placeholder="검색: 제목, 재료, 태그">
  <select id="sortSelect" aria-label="정렬">
    <option value="updatedDesc">최근 수정순</option>
    <option value="titleAsc">제목 A→Z</option>
    <option value="timeAsc">소요시간 짧은순</option>
    <option value="timeDesc">소요시간 긴순</option>
  </select>
  <div id="tagChips" class="chips"></div>
</section>

<main>
  <ul id="recipeList" class="cards"></ul>
  <button id="aiFab" title="AI 도우미">AI</button>
</main>

<dialog id="recipeDialog">
  <form method="dialog" id="recipeForm">
    <h2 id="dialogTitle">새 레시피</h2>
    <div class="grid">
      <label>제목*<input name="title" required maxlength="100" placeholder="예: 말차 오페라"></label>
      <label>난이도
        <select name="difficulty"><option value="">선택 없음</option><option>초급</option><option>중급</option><option>고급</option></select></label>
      <label>소요시간(분)<input name="time" type="number" min="0" step="1" placeholder="예: 90"></label>
      <label>분량(인분/개수)<input name="yield" maxlength="40" placeholder="예: 8인분"></label>
      <label>태그(쉼표로 구분)<input name="tags" maxlength="120" placeholder="예: 프랑스, 푸딩"></label>
      <label>표지 이미지 URL<input name="image" placeholder="https:// ... (선택)"></label>
    </div>
    <label>한 줄 소개<input name="summary" maxlength="160" placeholder="예: 바닐라 향이 포인트인 기본 푸딩"></label>
    <label>재료(한 줄당 하나)
      <textarea name="ingredients" rows="8" placeholder="우유 500ml
생크림 200ml
설탕 70g
달걀 3개
바닐라 빈 1/2개
소금 한 꼬집"></textarea></label>
    <label>만드는 법(단계별로)
      <textarea name="steps" rows="10" placeholder="1) 오븐 150°C 예열
2) 우유+크림을 데워 향 우려내기
3) 달걀+설탕 섞기
4) 따뜻한 우유 혼합물 조금씩 넣어 섞기
5) 체에 걸러 중탕으로 30분 굽기"></textarea></label>
    <label>비고/메모
      <textarea name="notes" rows="6" placeholder="팁, 대체 재료, 실패 노트 등"></textarea></label>
    <menu><button value="cancel" id="cancelBtn">취소</button><button id="saveBtn" value="default">저장</button></menu>
  </form>
</dialog>

<template id="recipeCardTmpl">
  <li class="card">
    <div class="thumb"></div>
    <div class="content">
      <h3 class="title"></h3>
      <p class="summary"></p>
      <div class="meta"><span class="badge time"></span><span class="badge diff"></span><span class="badge yield"></span></div>
      <div class="tags"></div>
      <details>
        <summary>레시피 펼치기</summary>
        <div class="two-col">
          <div><h4>재료</h4><ul class="ing"></ul></div>
          <div><h4>만드는 법</h4><ol class="steps"></ol></div>
        </div>
        <div class="notes"></div>
      </details>
      <div class="row"><button class="edit">수정</button><button class="delete">삭제</button><button class="dup">복제</button></div>
    </div>
  </li>
</template>

<footer><small>저장 위치: 이 기기 브라우저(localStorage) · JSON으로 백업하세요</small></footer>

<dialog id="aiDialog">
  <form method="dialog" id="aiForm">
    <h2>AI 도우미 <small class="muted">(키 저장 시 실제 응답)</small></h2>
    <p class="muted">재료로 레시피 추천, 단계 요약, 단위 변환 등을 물어보세요.</p>
    <textarea id="aiInput" rows="4" placeholder="예: 달걀·우유·말차로 디저트 추천"></textarea>
    <menu><button value="cancel">닫기</button><button id="aiAskBtn" value="default">질문 보내기</button></menu>
    <div id="aiResult" class="ai-result"></div>
    <hr>
    <details>
      <summary>설정: OpenAI API 키 연결</summary>
      <label>OpenAI API Key
        <input type="password" id="apiKeyInput" placeholder="sk-..." style="width:100%">
      </label>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button type="button" id="saveKeyBtn">키 저장</button>
        <button type="button" id="clearKeyBtn" class="btn-grey">키 삭제</button>
      </div>
      <p class="muted" id="keyStatus"></p>
    </details>
  </form>
</dialog>

<div id="toast" class="toast">복사 완료</div>

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').catch(()=>{});
  }
</script>
<script src="app.js"></script>
</body>
</html>
